(executable
 (name tunnel)
 (modules tunnel)
 (libraries
  cmdliner
  fmt
  fmt.tty
  logs
  logs.fmt
  scrutiny_infrastructure
  scrutiny_infrastructure_resources_internal
  unix))

(rule
 (target tunnel.strip.exe)
 (action
  (run strip -o %{target} %{dep:tunnel.exe})))

(rule
 (target tunnel.min.exe)
 (action
  (run upx -o %{target} %{dep:tunnel.strip.exe})))

(install
 (section bin)
 (package scrutiny)
 (files
  (tunnel.min.exe as scrutiny-infra-tunnel)))
